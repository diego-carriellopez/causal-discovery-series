<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Causal Discovery in Drug Discovery</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=IBM+Plex+Mono:wght@400;500;600&family=Outfit:wght@200;300;400;500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#f4f7f6;--surface:#ffffff;--surface2:#edf2f0;--surface3:#e3ebe7;--border:#cdd8d2;--border2:#b8c8bf;--text:#1a2e24;--text-dim:#5e7a6c;--teal:#0d9488;--teal-dim:rgba(13,148,136,0.08);--teal-mid:rgba(13,148,136,0.25);--violet:#7c3aed;--violet-dim:rgba(124,58,237,0.08);--rose:#e11d48;--rose-dim:rgba(225,29,72,0.07);--amber:#d97706;--amber-dim:rgba(217,119,6,0.08);--green:#059669;--green-dim:rgba(5,150,105,0.08);--sky:#0284c7;}
*{margin:0;padding:0;box-sizing:border-box;}
body{background:var(--bg);color:var(--text);font-family:'Outfit',sans-serif;font-weight:300;line-height:1.75;overflow-x:hidden;}
body::before{content:'';position:fixed;inset:0;opacity:.03;background-image:url("data:image/svg+xml,%3Csvg width='60' height='52' viewBox='0 0 60 52' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 0L60 15v22L30 52 0 37V15z' fill='none' stroke='%230d9488' stroke-width='.5'/%3E%3C/svg%3E");pointer-events:none;}
.container{max-width:940px;margin:0 auto;padding:0 26px;position:relative;z-index:1;}
header{padding:72px 0 44px;border-bottom:1px solid var(--border);}
.tag{display:inline-block;font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:2.5px;text-transform:uppercase;padding:4px 14px;border-radius:3px;margin-bottom:20px;color:var(--teal);border:1.5px solid var(--teal-mid);background:var(--teal-dim);}
h1{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,5vw,3rem);font-weight:700;line-height:1.15;margin-bottom:14px;}
h1 .hl{color:var(--teal);}
h1 em{font-style:italic;color:var(--violet);}
header>p{font-size:1.05rem;color:var(--text-dim);max-width:600px;}
section{margin:50px 0;}
.stag{font-family:'IBM Plex Mono',monospace;font-size:10px;letter-spacing:2.5px;text-transform:uppercase;color:var(--teal);margin-bottom:8px;display:block;}
h2{font-family:'Cormorant Garamond',serif;font-size:1.55rem;font-weight:700;margin-bottom:12px;line-height:1.3;}
p{margin-bottom:12px;}
.mono{font-family:'IBM Plex Mono',monospace;font-size:.82em;background:var(--surface2);padding:2px 7px;border-radius:3px;color:var(--teal);}
.callout{border-left:3px solid var(--teal);background:var(--teal-dim);padding:14px 18px;border-radius:0 8px 8px 0;margin:18px 0;font-size:.9rem;}
.callout.violet{border-color:var(--violet);background:var(--violet-dim);}
.callout.rose{border-color:var(--rose);background:var(--rose-dim);}
.callout.green{border-color:var(--green);background:var(--green-dim);}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin:20px 0;}
.crd{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:20px;transition:transform .25s,box-shadow .25s;}
.crd:hover{transform:translateY(-2px);box-shadow:0 6px 24px rgba(0,0,0,.06);}
.crd .ico{font-size:1.4rem;margin-bottom:8px;display:block;}
.crd h3{font-family:'IBM Plex Mono',monospace;font-size:.72rem;font-weight:600;color:var(--teal);margin-bottom:4px;letter-spacing:.5px;text-transform:uppercase;}
.crd p{font-size:.85rem;color:var(--text-dim);margin:0;line-height:1.55;}
.panel{background:var(--surface);border:1px solid var(--border);border-radius:10px;overflow:hidden;margin:18px 0;}
.panel-bar{display:flex;justify-content:space-between;align-items:center;padding:12px 18px;border-bottom:1px solid var(--border);flex-wrap:wrap;gap:8px;}
.panel-bar h3{font-family:'Cormorant Garamond',serif;font-size:.95rem;font-weight:700;}
.ctrls{display:flex;gap:8px;align-items:center;flex-wrap:wrap;}
.btn{font-family:'IBM Plex Mono',monospace;font-size:9px;letter-spacing:1px;text-transform:uppercase;border:none;padding:6px 14px;border-radius:4px;cursor:pointer;font-weight:600;transition:all .2s;}
.btn:hover{filter:brightness(1.08);transform:translateY(-1px);}
.btn.teal{background:var(--teal);color:#fff;}
.btn.violet{background:var(--violet);color:#fff;}
.btn.rose{background:var(--rose);color:#fff;}
.btn.outline{background:transparent;border:1px solid var(--teal);color:var(--teal);}
canvas{width:100%;height:100%;display:block;}
.cwrap{position:relative;width:100%;height:420px;}
.srow{display:flex;gap:16px;padding:10px 18px;border-top:1px solid var(--border);flex-wrap:wrap;}
.st{display:flex;align-items:baseline;gap:4px;}
.st-l{font-family:'IBM Plex Mono',monospace;font-size:8px;letter-spacing:1px;text-transform:uppercase;color:var(--text-dim);}
.st-v{font-family:'IBM Plex Mono',monospace;font-size:13px;font-weight:600;}
.lrow{display:flex;gap:14px;padding:8px 18px;border-top:1px solid var(--border);flex-wrap:wrap;}
.litm{display:flex;align-items:center;gap:4px;font-family:'IBM Plex Mono',monospace;font-size:8px;letter-spacing:.5px;text-transform:uppercase;color:var(--text-dim);}
.ldot{width:8px;height:8px;border-radius:50%;}
.mol-table{width:100%;border-collapse:collapse;font-size:.85rem;}
.mol-table th{font-family:'IBM Plex Mono',monospace;font-size:.7rem;letter-spacing:1px;text-transform:uppercase;color:var(--text-dim);text-align:left;padding:8px 12px;border-bottom:2px solid var(--border);font-weight:500;}
.mol-table td{padding:8px 12px;border-bottom:1px solid var(--surface2);}
.mol-table tr:hover{background:var(--teal-dim);}
.mol-table .scaffold{font-family:'IBM Plex Mono',monospace;font-size:.78rem;font-weight:600;color:var(--teal);}
.mol-table .signal-bar{display:inline-block;height:6px;border-radius:3px;vertical-align:middle;}
.mol-table .hidden-tag{font-family:'IBM Plex Mono',monospace;font-size:.65rem;padding:2px 6px;border-radius:3px;}
.flow{display:flex;align-items:center;justify-content:center;gap:0;margin:24px 0;flex-wrap:wrap;}
.flow-step{background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:14px 18px;text-align:center;min-width:130px;transition:all .3s;}
.flow-step:hover{border-color:var(--teal);box-shadow:0 4px 16px rgba(0,0,0,.05);}
.flow-step .ico{font-size:1.2rem;margin-bottom:5px;display:block;}
.flow-step h4{font-family:'IBM Plex Mono',monospace;font-size:.6rem;letter-spacing:1px;text-transform:uppercase;color:var(--teal);margin-bottom:2px;}
.flow-step p{font-size:.75rem;color:var(--text-dim);margin:0;line-height:1.3;}
.flow-arr{font-size:1.3rem;color:var(--border2);padding:0 6px;font-family:'IBM Plex Mono',monospace;}
@media(max-width:700px){.flow{flex-direction:column;}.flow-arr{transform:rotate(90deg);}}
.vs{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin:20px 0;}
@media(max-width:640px){.vs{grid-template-columns:1fr;}}
.vs-box{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:20px;}
.vs-box h4{font-family:'IBM Plex Mono',monospace;font-size:.7rem;letter-spacing:1px;text-transform:uppercase;margin-bottom:10px;}
.vs-box.old h4{color:var(--rose);}
.vs-box.new h4{color:var(--green);}
.vs-box ul{list-style:none;padding:0;}
.vs-box li{font-size:.86rem;color:var(--text-dim);padding:5px 0;border-bottom:1px solid var(--surface2);display:flex;align-items:center;gap:6px;}
.vs-box li:last-child{border:none;}
.vs-box li .dot{width:5px;height:5px;border-radius:50%;flex-shrink:0;}
.vs-box.old .dot{background:var(--rose);}
.vs-box.new .dot{background:var(--green);}
.punch{background:var(--text);color:var(--bg);border-radius:12px;padding:40px;text-align:center;margin:40px 0;position:relative;overflow:hidden;}
.punch::before{content:'';position:absolute;top:-40%;left:-40%;width:180%;height:180%;background:radial-gradient(circle at 60% 40%,rgba(13,148,136,0.08) 0%,transparent 50%);pointer-events:none;}
.punch h2{font-family:'Cormorant Garamond',serif;font-size:1.5rem;color:var(--bg);margin-bottom:10px;position:relative;}
.punch p{color:rgba(244,247,246,0.6);max-width:540px;margin:0 auto;font-size:.95rem;position:relative;}
.punch .big{font-family:'IBM Plex Mono',monospace;font-size:1.8rem;font-weight:600;color:var(--teal);display:block;margin:14px 0;position:relative;}
footer{text-align:center;padding:40px 0 28px;color:var(--text-dim);font-size:.78rem;border-top:1px solid var(--border);margin-top:40px;}
</style>
</head>
<body>
<div class="container">
<header>
  <div class="tag">Drug Discovery Use Case</div>
  <h1>Finding <span class="hl">Hidden Binders</span> in<br><em>Virtual Chemical Space</em></h1>
  <p>How causal discovery reveals therapeutic molecules masked by confounding properties and guides virtual screening beyond physical libraries.</p>
</header>

<section>
  <span class="stag">01 ‚Äî The Problem</span>
  <h2>Your physical library is a tiny window into chemical space</h2>
  <p>Drug discovery screens typically test 10K-100K compounds. But drug-like chemical space contains ~<span class="mono">10^60</span> molecules. Your screen is a grain of sand on a beach.</p>
  <p>Worse: many genuine binders <strong>show weak signals</strong> ‚Äî not because they don't bind, but because confounding properties (poor solubility, aggregation) mask their true affinity.</p>
  <div class="grid">
    <div class="crd"><span class="ico">üß™</span><h3>Physical Library</h3><p>~50K compounds tested. Limited by synthesis capacity, cost, and time.</p></div>
    <div class="crd"><span class="ico">üåå</span><h3>Virtual Space</h3><p>Billions of enumerable molecules. Can't test them all, but can predict which to prioritize.</p></div>
    <div class="crd"><span class="ico">üìâ</span><h3>Low Signals</h3><p>Weak hits dismissed as noise. But some are genuine binders masked by poor solubility.</p></div>
    <div class="crd"><span class="ico">üîç</span><h3>Hidden Binders</h3><p>Best therapeutic molecules may hide in families you dismissed ‚Äî or virtual space you never explored.</p></div>
  </div>
</section>

<section>
  <span class="stag">02 ‚Äî The Screening Data</span>
  <h2>Five molecular families, one kinase target</h2>
  <p>We screened five scaffold families. Families C and E seem uninteresting. But are they really?</p>
  <div class="panel">
    <div class="panel-bar"><h3>HTS Screening Results</h3></div>
    <div style="padding:14px 18px;overflow-x:auto;">
      <table class="mol-table"><thead><tr><th>Family</th><th>Core</th><th># Screened</th><th>LogP</th><th>Solubility</th><th>Signal</th><th>Verdict</th></tr></thead><tbody>
        <tr><td class="scaffold">A ‚Äî Pyridines</td><td>Pyridine</td><td>8,420</td><td>2.1</td><td>High</td><td><span class="signal-bar" style="width:120px;background:var(--green);"></span></td><td><span class="hidden-tag" style="color:var(--green);background:var(--green-dim);">HIT</span></td></tr>
        <tr><td class="scaffold">B ‚Äî Quinazolines</td><td>Quinazoline</td><td>6,230</td><td>2.8</td><td>Medium</td><td><span class="signal-bar" style="width:90px;background:var(--green);"></span></td><td><span class="hidden-tag" style="color:var(--green);background:var(--green-dim);">HIT</span></td></tr>
        <tr><td class="scaffold" style="color:var(--violet);">C ‚Äî Indazoles</td><td>Indazole</td><td>4,100</td><td style="color:var(--rose);">4.2</td><td style="color:var(--rose);">Low ‚ö†</td><td><span class="signal-bar" style="width:30px;background:#999;"></span></td><td><span class="hidden-tag" style="color:var(--rose);background:var(--rose-dim);">DISMISSED</span></td></tr>
        <tr><td class="scaffold">D ‚Äî Benzimidazoles</td><td>Benzimidazole</td><td>7,800</td><td>1.5</td><td>High</td><td><span class="signal-bar" style="width:70px;background:var(--amber);"></span></td><td><span class="hidden-tag" style="color:var(--text-dim);background:var(--surface2);">WEAK</span></td></tr>
        <tr><td class="scaffold" style="color:var(--violet);">E ‚Äî Thiazo.pyrimidines</td><td>Thiazo[4,5-d]pyr.</td><td>2,900</td><td style="color:var(--rose);">4.8</td><td style="color:var(--rose);">Very low ‚ö†</td><td><span class="signal-bar" style="width:18px;background:#999;"></span></td><td><span class="hidden-tag" style="color:var(--rose);background:var(--rose-dim);">DISMISSED</span></td></tr>
      </tbody></table>
    </div>
  </div>
  <div class="callout rose"><strong>The trap:</strong> Families C and E were dismissed because their apparent signal is weak. But look at their LogP (4.2, 4.8) and solubility. What if they DO bind, but precipitate out of solution before reaching the target?</div>
</section>

<section>
  <span class="stag">03 ‚Äî Chemical Space Map</span>
  <h2>Physical vs virtual molecular space</h2>
  <p>This 2D projection shows your screened library as colored dots. Gray cloud is <strong>virtual chemical space</strong>. Press <strong>Reveal Hidden Binders</strong> to see what causal discovery uncovers.</p>
  <div class="panel">
    <div class="panel-bar">
      <h3>Chemical Space Explorer</h3>
      <div class="ctrls">
        <button class="btn outline" id="resetSpaceBtn">Reset</button>
        <button class="btn violet" id="revealBtn">Reveal Hidden Binders</button>
        <button class="btn teal" id="virtualBtn">Explore Virtual Space</button>
      </div>
    </div>
    <div class="cwrap"><canvas id="spaceCanvas"></canvas></div>
    <div class="lrow">
      <div class="litm"><div class="ldot" style="background:var(--green);"></div> Strong binder</div>
      <div class="litm"><div class="ldot" style="background:var(--amber);"></div> Weak signal</div>
      <div class="litm"><div class="ldot" style="background:rgba(90,90,90,0.3);"></div> Virtual space</div>
      <div class="litm"><div class="ldot" style="background:var(--violet);"></div> Hidden binder</div>
      <div class="litm"><div class="ldot" style="background:var(--teal);"></div> Virtual candidate</div>
    </div>
    <div class="srow">
      <div class="st"><span class="st-l">Physical</span><span class="st-v" style="color:var(--green);" id="spPhysical">450</span></div>
      <div class="st"><span class="st-l">Virtual</span><span class="st-v" style="color:var(--text-dim);">~2,000</span></div>
      <div class="st"><span class="st-l">Hidden binders</span><span class="st-v" style="color:var(--violet);" id="spHidden">‚Äî</span></div>
      <div class="st"><span class="st-l">Virtual candidates</span><span class="st-v" style="color:var(--teal);" id="spCandidates">‚Äî</span></div>
    </div>
  </div>
</section>

<section>
  <span class="stag">04 ‚Äî The Causal Graph</span>
  <h2>Why weak signal ‚â† weak binder</h2>
  <p>Causal discovery builds a DAG linking molecular descriptors to assay outcomes. The critical insight: <strong>solubility is a confounder</strong> that affects apparent signal without affecting true binding affinity.</p>
  <div class="panel">
    <div class="panel-bar"><h3>Discovered Causal Network</h3><div class="ctrls"><button class="btn teal" id="causalBtn">Run Causal Discovery</button></div></div>
    <div class="cwrap" style="height:380px;"><canvas id="causalCanvas"></canvas></div>
    <div class="lrow">
      <div class="litm"><div class="ldot" style="background:var(--rose);"></div> Confounder (masks signal)</div>
      <div class="litm"><div class="ldot" style="background:var(--green);"></div> True binding path</div>
      <div class="litm"><div class="ldot" style="background:var(--text-dim);"></div> Other</div>
    </div>
  </div>
  <div class="callout violet"><strong>Key discovery:</strong> Two distinct pathways to apparent signal:<br>1. <strong style="color:var(--green);">Scaffold ‚Üí H-bond donors ‚Üí Pocket fit ‚Üí True affinity ‚Üí Signal</strong> (real)<br>2. <strong style="color:var(--rose);">Scaffold ‚Üí High LogP ‚Üí Low solubility ‚Üí Low apparent signal</strong> (confounder)<br><br>Families C and E have excellent pocket geometry but terrible solubility. True affinity is <strong>masked</strong>.</div>
</section>

<section>
  <span class="stag">05 ‚Äî Deconfounding</span>
  <h2>Corrected affinity vs. apparent signal</h2>
  <p>Once the causal graph identifies solubility as a confounder, we estimate the <strong>true deconfounded affinity</strong>. The results are dramatic.</p>
  <div class="panel">
    <div class="panel-bar"><h3>Apparent Signal vs. Estimated True Affinity</h3></div>
    <div style="padding:16px 18px;"><canvas id="deconfCanvas" height="260"></canvas></div>
    <div class="lrow">
      <div class="litm"><div class="ldot" style="background:rgba(100,116,139,0.4);"></div> Apparent signal</div>
      <div class="litm"><div class="ldot" style="background:var(--violet);"></div> True affinity (deconfounded)</div>
    </div>
  </div>
  <div class="callout green"><strong>Result:</strong> Family C jumps from "weak" to <strong>second-best binder</strong>. Family E from "noise" to <strong>moderate binder</strong>. These families were hiding in plain sight ‚Äî penalized by solubility, not poor binding.</div>
</section>

<section>
  <span class="stag">06 ‚Äî Virtual Space Navigation</span>
  <h2>Using the causal model to explore virtual space</h2>
  <p>Now we know Families C and E have hidden affinity. We search virtual space for <strong>analogs with better solubility</strong>: keep the binding scaffold, modify R-groups to reduce LogP.</p>
  <div class="flow">
    <div class="flow-step"><span class="ico">üß¨</span><h4>Scaffold</h4><p>Keep indazole core</p></div>
    <div class="flow-arr">‚Üí</div>
    <div class="flow-step"><span class="ico">üîß</span><h4>Modify</h4><p>Add polar R-groups</p></div>
    <div class="flow-arr">‚Üí</div>
    <div class="flow-step"><span class="ico">üíß</span><h4>Predict</h4><p>Causal model scores</p></div>
    <div class="flow-arr">‚Üí</div>
    <div class="flow-step"><span class="ico">üéØ</span><h4>Select</h4><p>Top 50 candidates</p></div>
    <div class="flow-arr">‚Üí</div>
    <div class="flow-step"><span class="ico">‚úÖ</span><h4>Validate</h4><p>Synthesize & test</p></div>
  </div>
  <div class="panel">
    <div class="panel-bar"><h3>Virtual Screening ‚Äî Top Candidates</h3></div>
    <div style="padding:14px 18px;overflow-x:auto;">
      <table class="mol-table"><thead><tr><th>ID</th><th>Family</th><th>Modification</th><th>Pred. LogP</th><th>Solubility</th><th>Pred. Affinity</th><th>Priority</th></tr></thead><tbody>
        <tr><td class="scaffold">VC-001</td><td>C</td><td>Morpholino at R2</td><td>2.4</td><td style="color:var(--green);">High</td><td><span class="signal-bar" style="width:110px;background:var(--teal);"></span></td><td><span class="hidden-tag" style="color:#fff;background:var(--teal);">‚òÖ‚òÖ‚òÖ</span></td></tr>
        <tr><td class="scaffold">VC-002</td><td>C</td><td>Piperazine at R1</td><td>2.8</td><td style="color:var(--green);">High</td><td><span class="signal-bar" style="width:95px;background:var(--teal);"></span></td><td><span class="hidden-tag" style="color:#fff;background:var(--teal);">‚òÖ‚òÖ‚òÖ</span></td></tr>
        <tr><td class="scaffold">VC-003</td><td>E</td><td>Glycol chain at R3</td><td>2.1</td><td style="color:var(--green);">High</td><td><span class="signal-bar" style="width:80px;background:var(--teal);"></span></td><td><span class="hidden-tag" style="color:#fff;background:var(--green);">‚òÖ‚òÖ</span></td></tr>
        <tr><td class="scaffold">VC-004</td><td>E</td><td>Sulfonamide at R2</td><td>2.5</td><td style="color:var(--green);">Med-High</td><td><span class="signal-bar" style="width:72px;background:var(--teal);"></span></td><td><span class="hidden-tag" style="color:#fff;background:var(--green);">‚òÖ‚òÖ</span></td></tr>
        <tr><td class="scaffold">VC-005</td><td>C</td><td>Aminopyridine at R3</td><td>3.0</td><td style="color:var(--amber);">Medium</td><td><span class="signal-bar" style="width:100px;background:var(--teal);"></span></td><td><span class="hidden-tag" style="color:#fff;background:var(--amber);">‚òÖ‚òÖ</span></td></tr>
      </tbody></table>
    </div>
    <div class="srow">
      <div class="st"><span class="st-l">Virtual screened</span><span class="st-v" style="color:var(--teal);">12,400</span></div>
      <div class="st"><span class="st-l">Selected</span><span class="st-v" style="color:var(--violet);">50</span></div>
      <div class="st"><span class="st-l">Pred. hit rate</span><span class="st-v" style="color:var(--green);">38%</span></div>
    </div>
  </div>
</section>

<section>
  <span class="stag">07 ‚Äî The Impact</span>
  <h2>Traditional screening vs. causal-guided discovery</h2>
  <div class="vs">
    <div class="vs-box old"><h4>Traditional QSAR / ML</h4><ul>
      <li><span class="dot"></span> Trains on apparent signal (confounded)</li>
      <li><span class="dot"></span> Predicts: "Family C won't work"</li>
      <li><span class="dot"></span> Focuses on Family A/B analogs only</li>
      <li><span class="dot"></span> Misses entire scaffold families</li>
      <li><span class="dot"></span> Hit rate in validation: ~8%</li>
    </ul></div>
    <div class="vs-box new"><h4>Causal Discovery + Virtual Screening</h4><ul>
      <li><span class="dot"></span> Deconfounds solubility from affinity</li>
      <li><span class="dot"></span> Reveals: "Family C has hidden potential"</li>
      <li><span class="dot"></span> Explores novel scaffold regions</li>
      <li><span class="dot"></span> Explains WHY signals are weak (actionable)</li>
      <li><span class="dot"></span> Hit rate in validation: ~38%</li>
    </ul></div>
  </div>
</section>

<div class="punch">
  <h2>The Punchline</h2>
  <span class="big">Low signal ‚â† Low affinity</span>
  <p>Causal discovery disentangles true binding affinity from confounders, unlocking molecular families that traditional screens dismiss. Your next drug candidate might be hiding in the data you already have.</p>
</div>

<section>
  <span class="stag">08 ‚Äî Back to Theory</span>
  <h2>Why theoretical guarantees matter here</h2>
  <p>The paper's FNR concentration result applies directly: your "variables" are molecular descriptors, and modern cheminformatics gives you <strong>hundreds</strong> per molecule.</p>
  <div class="grid">
    <div class="crd"><span class="ico">üìä</span><h3>High Dimensionality Helps</h3><p>200+ descriptors (MW, LogP, PSA, fingerprints, 3D shape...) means the causal model benefits from concentration.</p></div>
    <div class="crd"><span class="ico">üï∏Ô∏è</span><h3>Scale-Free Structure</h3><p>Descriptor networks are naturally scale-free ‚Äî a few hub properties (LogP, HBD) give stronger concentration.</p></div>
    <div class="crd"><span class="ico">üß™</span><h3>Interventions = SAR</h3><p>Every R-group modification is an "intervention." Medicinal chemistry naturally generates causal data.</p></div>
    <div class="crd"><span class="ico">üîÑ</span><h3>Iterative Design</h3><p>Each make-test-analyze cycle refines the causal graph. Your pipeline is a causal learning machine.</p></div>
  </div>
</section>

<footer>Drug Discovery Use Case ‚Äî Causal Discovery for Hidden Binder Identification</footer>
</div>

<script>
var dpr=window.devicePixelRatio||1;
function resize(c){var r=c.parentElement.getBoundingClientRect();c.width=r.width*dpr;c.height=r.height*dpr;c.style.width=r.width+'px';c.style.height=r.height+'px';}

var spaceState='normal';
var molecules=[],virtualMols=[],hiddenBinders=[],virtualCandidates=[];

function initMolecules(){
  molecules=[];virtualMols=[];hiddenBinders=[];virtualCandidates=[];
  var families=[
    {name:'A',color:'#059669',cx:.25,cy:.35,rx:.08,ry:.06,n:90,strong:true},
    {name:'B',color:'#059669',cx:.4,cy:.5,rx:.07,ry:.07,n:70,strong:true},
    {name:'C',color:'#a3a3a3',cx:.7,cy:.3,rx:.06,ry:.05,n:50,hidden:true},
    {name:'D',color:'#d97706',cx:.35,cy:.7,rx:.07,ry:.05,n:80},
    {name:'E',color:'#a3a3a3',cx:.8,cy:.65,rx:.05,ry:.06,n:35,hidden:true},
  ];
  families.forEach(function(f){
    for(var i=0;i<f.n;i++){
      var a=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());
      molecules.push({x:f.cx+Math.cos(a)*r*f.rx+(Math.random()-.5)*.02,y:f.cy+Math.sin(a)*r*f.ry+(Math.random()-.5)*.02,family:f.name,color:f.strong?f.color:(f.hidden?'#a3a3a3':'#d97706'),size:f.strong?(2+Math.random()*1.5):(1.5+Math.random()),hidden:f.hidden||false});
    }
  });
  for(var i=0;i<1500;i++) virtualMols.push({x:.05+Math.random()*.9,y:.05+Math.random()*.9,size:.8+Math.random()*.5});
  families.filter(function(f){return f.hidden;}).forEach(function(f){
    for(var i=0;i<20;i++){var a=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());hiddenBinders.push({x:f.cx+Math.cos(a)*r*f.rx+(Math.random()-.5)*.015,y:f.cy+Math.sin(a)*r*f.ry+(Math.random()-.5)*.015,family:f.name});}
    for(var i=0;i<30;i++){var a=Math.random()*Math.PI*2,r=Math.sqrt(Math.random());virtualCandidates.push({x:f.cx+Math.cos(a)*r*(f.rx*1.6)+(Math.random()-.5)*.04,y:f.cy+Math.sin(a)*r*(f.ry*1.6)+(Math.random()-.5)*.04,family:f.name});}
  });
}

function drawSpace(){
  var cvs=document.getElementById('spaceCanvas');resize(cvs);
  var c=cvs.getContext('2d'),w=cvs.width,h=cvs.height;c.clearRect(0,0,w,h);
  virtualMols.forEach(function(m){c.beginPath();c.arc(m.x*w,m.y*h,m.size*dpr,0,Math.PI*2);c.fillStyle='rgba(90,90,90,0.08)';c.fill();});
  if(spaceState==='virtual'){
    virtualCandidates.forEach(function(m){c.beginPath();c.arc(m.x*w,m.y*h,4*dpr,0,Math.PI*2);c.fillStyle='rgba(13,148,136,0.5)';c.fill();c.strokeStyle='rgba(13,148,136,0.3)';c.lineWidth=dpr;c.stroke();});
    [[.7,.3,.12],[.8,.65,.11]].forEach(function(r){c.beginPath();c.arc(r[0]*w,r[1]*h,r[2]*Math.min(w,h),0,Math.PI*2);c.strokeStyle='rgba(13,148,136,0.3)';c.lineWidth=1.5*dpr;c.setLineDash([6*dpr,4*dpr]);c.stroke();c.setLineDash([]);});
  }
  molecules.forEach(function(m){c.beginPath();c.arc(m.x*w,m.y*h,m.size*dpr,0,Math.PI*2);c.fillStyle=(spaceState!=='normal'&&m.hidden)?'#7c3aed':m.color;c.globalAlpha=.65;c.fill();c.globalAlpha=1;});
  if(spaceState!=='normal'){
    hiddenBinders.forEach(function(m){
      c.beginPath();c.arc(m.x*w,m.y*h,4.5*dpr,0,Math.PI*2);c.fillStyle='rgba(124,58,237,0.7)';c.fill();
      c.beginPath();c.arc(m.x*w,m.y*h,10*dpr,0,Math.PI*2);var g=c.createRadialGradient(m.x*w,m.y*h,2*dpr,m.x*w,m.y*h,10*dpr);g.addColorStop(0,'rgba(124,58,237,0.2)');g.addColorStop(1,'rgba(124,58,237,0)');c.fillStyle=g;c.fill();
    });
  }
  [{t:'Family A',x:.25,y:.22,c:'#059669'},{t:'Family B',x:.4,y:.39,c:'#059669'},{t:'Family C',x:.7,y:.18,c:spaceState!=='normal'?'#7c3aed':'#888'},{t:'Family D',x:.35,y:.82,c:'#d97706'},{t:'Family E',x:.8,y:.78,c:spaceState!=='normal'?'#7c3aed':'#888'}].forEach(function(l){
    c.fillStyle=l.c;c.font='bold '+(9*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='center';c.fillText(l.t,l.x*w,l.y*h);
  });
  c.fillStyle='#5e7a6c';c.font=(8*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='center';c.fillText('UMAP-1',w/2,h-6*dpr);
  c.save();c.translate(12*dpr,h/2);c.rotate(-Math.PI/2);c.fillText('UMAP-2',0,0);c.restore();
  document.getElementById('spHidden').textContent=spaceState!=='normal'?hiddenBinders.length:'‚Äî';
  document.getElementById('spCandidates').textContent=spaceState==='virtual'?virtualCandidates.length:'‚Äî';
}

document.getElementById('resetSpaceBtn').addEventListener('click',function(){spaceState='normal';drawSpace();});
document.getElementById('revealBtn').addEventListener('click',function(){spaceState='revealed';drawSpace();});
document.getElementById('virtualBtn').addEventListener('click',function(){spaceState='virtual';drawSpace();});

var causalDiscovered=false;
var causalNodes=[
  {id:'scaffold',name:'Scaffold',x:.08,y:.5,color:'#0d9488'},
  {id:'logp',name:'LogP',x:.27,y:.22,color:'#d97706'},
  {id:'hbd',name:'H-Bond Donors',x:.27,y:.78,color:'#059669'},
  {id:'mw',name:'Mol Weight',x:.27,y:.5,color:'#64748b'},
  {id:'sol',name:'Solubility',x:.48,y:.18,color:'#e11d48'},
  {id:'fit',name:'Pocket Fit',x:.48,y:.82,color:'#059669'},
  {id:'psa',name:'Polar SA',x:.48,y:.5,color:'#64748b'},
  {id:'aff',name:'True Affinity',x:.72,y:.72,color:'#059669'},
  {id:'conc',name:'Eff. Conc.',x:.72,y:.28,color:'#e11d48'},
  {id:'signal',name:'Signal',x:.92,y:.5,color:'#7c3aed'},
];
var causalEdgesData=[
  {from:'scaffold',to:'logp',type:'conf'},{from:'scaffold',to:'hbd',type:'true'},
  {from:'scaffold',to:'mw',type:'other'},{from:'logp',to:'sol',type:'conf'},
  {from:'hbd',to:'fit',type:'true'},{from:'mw',to:'psa',type:'other'},
  {from:'psa',to:'sol',type:'conf'},{from:'fit',to:'aff',type:'true'},
  {from:'sol',to:'conc',type:'conf'},{from:'aff',to:'signal',type:'true'},
  {from:'conc',to:'signal',type:'conf'},
];

function drawCausal(){
  var cvs=document.getElementById('causalCanvas');resize(cvs);
  var c=cvs.getContext('2d'),w=cvs.width,h=cvs.height;c.clearRect(0,0,w,h);
  var typeCol={'true':'rgba(5,150,105,0.6)',conf:'rgba(225,29,72,0.5)',other:'rgba(100,116,139,0.15)'};
  var typeW={'true':2.5,conf:2.5,other:1};
  causalEdgesData.forEach(function(e){
    var fn=causalNodes.find(function(n){return n.id===e.from}),tn=causalNodes.find(function(n){return n.id===e.to});
    if(!fn||!tn) return;
    var x1=fn.x*w,y1=fn.y*h,x2=tn.x*w,y2=tn.y*h,dx=x2-x1,dy=y2-y1,len=Math.sqrt(dx*dx+dy*dy);
    if(len<1) return;
    var ux=dx/len,uy=dy/len,R=20*dpr;
    var col=causalDiscovered?typeCol[e.type]:'rgba(100,116,139,0.1)';
    c.beginPath();c.moveTo(x1+ux*R,y1+uy*R);c.lineTo(x2-ux*R,y2-uy*R);
    c.strokeStyle=col;c.lineWidth=(causalDiscovered?typeW[e.type]:1)*dpr;c.stroke();
    var ex=x2-ux*R,ey=y2-uy*R,a=Math.atan2(ey-(y1+uy*R),ex-(x1+ux*R)),hl=6*dpr;
    c.beginPath();c.moveTo(ex,ey);c.lineTo(ex-hl*Math.cos(a-.3),ey-hl*Math.sin(a-.3));c.lineTo(ex-hl*Math.cos(a+.3),ey-hl*Math.sin(a+.3));c.closePath();c.fillStyle=col;c.fill();
  });
  causalNodes.forEach(function(n){
    var x=n.x*w,y=n.y*h,R=18*dpr;
    if(causalDiscovered&&(n.id==='sol'||n.id==='conc'||n.id==='signal'||n.id==='aff')){
      c.beginPath();c.arc(x,y,R*1.6,0,Math.PI*2);var g=c.createRadialGradient(x,y,R*.3,x,y,R*1.6);g.addColorStop(0,n.color+'25');g.addColorStop(1,n.color+'00');c.fillStyle=g;c.fill();
    }
    c.beginPath();c.arc(x,y,R,0,Math.PI*2);c.fillStyle='#fff';c.fill();
    c.strokeStyle=causalDiscovered?n.color:'#cdd8d2';c.lineWidth=1.5*dpr;c.stroke();
    c.fillStyle=causalDiscovered?n.color:'#5e7a6c';c.font=(7*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='center';c.textBaseline='middle';c.fillText(n.name,x,y);
  });
  if(causalDiscovered){
    c.font='bold '+(8*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='center';
    c.fillStyle='#059669';c.fillText('TRUE BINDING PATH',(.5)*w,(.95)*h);
    c.fillStyle='#e11d48';c.fillText('CONFOUNDER PATH (SOLUBILITY)',(.5)*w,(.06)*h);
  }
}
document.getElementById('causalBtn').addEventListener('click',function(){causalDiscovered=true;drawCausal();});

function drawDeconf(){
  var cvs=document.getElementById('deconfCanvas');resize(cvs);
  var c=cvs.getContext('2d'),w=cvs.width,h=cvs.height;c.clearRect(0,0,w,h);
  var families=[{name:'A',apparent:.85,true_aff:.82},{name:'B',apparent:.62,true_aff:.58},{name:'C',apparent:.18,true_aff:.72},{name:'D',apparent:.42,true_aff:.38},{name:'E',apparent:.08,true_aff:.52}];
  var padL=50*dpr,padR=30*dpr,padT=25*dpr,padB=50*dpr,pw=w-padL-padR,ph=h-padT-padB,barW=pw/families.length;
  c.strokeStyle='rgba(205,216,210,0.5)';c.lineWidth=.5*dpr;
  for(var i=0;i<=5;i++){var y=padT+(i/5)*ph;c.beginPath();c.moveTo(padL,y);c.lineTo(padL+pw,y);c.stroke();c.fillStyle='#5e7a6c';c.font=(8*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='right';c.fillText(((5-i)*20)+'%',padL-8*dpr,y+4*dpr);}
  families.forEach(function(f,i){
    var cx=padL+(i+.5)*barW,bw=barW*.3;
    var ah=f.apparent*ph;c.fillStyle='rgba(100,116,139,0.25)';c.fillRect(cx-bw-2*dpr,padT+ph-ah,bw,ah);c.strokeStyle='rgba(100,116,139,0.4)';c.lineWidth=dpr;c.strokeRect(cx-bw-2*dpr,padT+ph-ah,bw,ah);
    var th=f.true_aff*ph;c.fillStyle='rgba(124,58,237,0.35)';c.fillRect(cx+2*dpr,padT+ph-th,bw,th);c.strokeStyle='rgba(124,58,237,0.5)';c.lineWidth=dpr;c.strokeRect(cx+2*dpr,padT+ph-th,bw,th);
    if(f.name==='C'||f.name==='E'){
      var ay=padT+ph-ah,ty=padT+ph-th;c.beginPath();c.moveTo(cx,ay);c.lineTo(cx,ty+4*dpr);c.strokeStyle='#7c3aed';c.lineWidth=1.5*dpr;c.setLineDash([3*dpr,2*dpr]);c.stroke();c.setLineDash([]);
      c.beginPath();c.moveTo(cx-4*dpr,ty+8*dpr);c.lineTo(cx,ty+2*dpr);c.lineTo(cx+4*dpr,ty+8*dpr);c.strokeStyle='#7c3aed';c.lineWidth=1.5*dpr;c.stroke();
      c.fillStyle='#7c3aed';c.font='bold '+(7*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='center';c.fillText('+'+((f.true_aff-f.apparent)*100).toFixed(0)+'%',cx,ty-6*dpr);
    }
    c.fillStyle=(f.name==='C'||f.name==='E')?'#7c3aed':'#1a2e24';c.font='bold '+(10*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='center';c.fillText(f.name,cx,padT+ph+20*dpr);
  });
  c.save();c.translate(10*dpr,padT+ph/2);c.rotate(-Math.PI/2);c.fillStyle='#5e7a6c';c.font=(8*dpr)+'px "IBM Plex Mono",monospace';c.textAlign='center';c.fillText('Binding Activity',0,0);c.restore();
}

initMolecules();drawSpace();drawCausal();drawDeconf();
window.addEventListener('resize',function(){drawSpace();drawCausal();drawDeconf();});
</script>
</body>
</html>
